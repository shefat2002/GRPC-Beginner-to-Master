# User Management gRPC - Project 3

This project demonstrates a comprehensive user management system with CRUD operations, server streaming, and in-memory data storage using gRPC.

## Project Structure

- **3.UserManagement_gRPC_Server**: gRPC server with complete user management system
- **3.UserManagement_gRPC_Client**: Interactive console client for user operations
- **Protos/usermanagement.proto**: Service contract with CRUD operations and streaming

## Features

### Server Features
- **CRUD Operations**: Create, Read, Update, Delete users
- **Server Streaming**: Real-time user listing with filtering
- **Data Validation**: Input validation and sanitization
- **Email Uniqueness**: Prevents duplicate email addresses
- **In-Memory Storage**: Thread-safe concurrent user storage
- **Error Handling**: Comprehensive error handling and logging
- **Business Logic**: Age validation, email format validation

### Client Features
- **Interactive Menu**: User-friendly console interface
- **All CRUD Operations**: Full user lifecycle management
- **Real-time Streaming**: Live user list updates
- **Filtering Support**: Search users by name or email
- **Pagination**: Control number of results returned
- **Input Validation**: Client-side input validation
- **Confirmation Dialogs**: Safe delete operations

## Running the Project

### Start the Server
```bash
cd 3.UserManagement_gRPC_Server
dotnet run
```
Server will start on https://localhost:7154

### Run the Client
```bash
cd 3.UserManagement_gRPC_Client
dotnet run
```

## Available Operations

### 1. Create User
- Add new users with name, email, and age
- Email uniqueness validation
- Input format validation
- Age range validation (0-150)

### 2. Get User
- Retrieve user details by ID
- Returns complete user information including timestamps

### 3. Update User
- Modify existing user information
- Shows current values before update
- Email uniqueness validation (excluding current user)
- Full input validation

### 4. Delete User
- Remove user by ID
- Confirmation dialog for safety
- Soft error handling for non-existent users

### 5. List All Users (Server Streaming)
- Real-time streaming of all users
- Progressive display as data arrives
- Shows creation and modification timestamps

### 6. List Users with Filter
- Filter by name or email content
- Optional page size limiting
- Real-time streaming with applied filters

## What You Learn

1. **CRUD Operations**: Complete lifecycle management via gRPC
2. **Server Streaming**: Real-time data streaming from server to client
3. **Data Persistence**: In-memory storage with thread safety
4. **Input Validation**: Both client and server-side validation
5. **Business Logic**: Email uniqueness, data sanitization
6. **Error Handling**: Graceful error handling and user feedback
7. **Concurrent Access**: Thread-safe data operations
8. **Streaming Patterns**: Efficient data streaming with filtering

## Technical Highlights

### Protocol Buffers
- Multiple message types for different operations
- Proper field numbering and types
- Optional parameters for filtering and pagination

### Server Implementation
- Dependency injection for storage abstraction
- Comprehensive logging throughout operations
- Business rule enforcement (email uniqueness)
- Input validation with descriptive error messages
- Thread-safe concurrent dictionary for storage

### Client Implementation
- Disposable pattern for proper resource cleanup
- Async/await throughout for non-blocking operations
- Interactive menu system with error handling
- Real-time streaming consumption
- User confirmation for destructive operations

## Example Usage

```
User Management Operations:
1. Create User
2. Get User
3. Update User
4. Delete User
5. List All Users
6. List Users with Filter
Q. Quit

Enter your choice (1-6) or 'Q' to quit: 1

=== Create User ===
Enter name: John Doe
Enter email: john.doe@email.com
Enter age: 30

âœ“ User created successfully
User ID: 1
Name: John Doe
Email: john.doe@email.com
Age: 30
Created: 2024-01-04 07:15:30 UTC
```

## Advanced Features

### Server Streaming Demo
The ListUsers operation demonstrates server streaming by:
- Progressively sending user data
- Adding small delays to show streaming effect
- Supporting cancellation via client disconnect
- Applying filters server-side before streaming

### Data Validation
- **Email Format**: Uses .NET EmailAddressAttribute
- **Age Range**: Validates reasonable age limits
- **Name Length**: Prevents excessively long names
- **Required Fields**: Ensures all mandatory data is provided

### Concurrency Safety
- Uses ConcurrentDictionary for thread-safe operations
- Atomic ID generation with Interlocked.Increment
- Safe concurrent read/write operations

## Next Steps

- Add user roles and permissions
- Implement data persistence (database integration)
- Add user search with advanced filtering
- Implement user authentication
- Add bulk operations (create/update/delete multiple users)
- Implement user activity logging
- Add user profile picture support
- Create user groups and relationships

## Error Scenarios Handled

- Invalid user IDs
- Duplicate email addresses
- Invalid email formats
- Age out of range
- Missing required fields
- Network connectivity issues
- Server unavailability
- Concurrent access conflicts

This project provides a solid foundation for understanding gRPC CRUD operations, server streaming, and building robust client-server applications with proper error handling and validation.